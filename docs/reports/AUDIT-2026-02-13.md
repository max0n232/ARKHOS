# Аудит проекта Studiokook — 2026-02-13

## CRITICAL: Безопасность

**Пароли в открытом виде в 15+ файлах.** WP_APP_PASS, OAuth client_secret, tokens — засвечены в SESSION-CHECKPOINT.md, check-translation.js, CLAUDE.md, docs/, skills/, scripts/ и др. Если этот репозиторий когда-либо попадёт в public — все ключи скомпрометированы.

Файлы с утечками:
- `SESSION-CHECKPOINT.md` — WP_APP_PASS прямо в тексте (строки 80-84)
- `check-translation.js`, `scripts/add-translation.js` — hardcoded credentials
- `skills/wp-elementor/SKILL.md`, `skills/wp-translatepress/SKILL.md` — примеры с реальными паролями
- `docs/plans/`, `docs/translation-guide.md` — реальные credentials
- `credentials/google_token.json` — OAuth access + refresh tokens в plaintext
- `agents/.env` — API ключ Anthropic

**Рекомендация:** Вынести ВСЕ credentials в `credentials/` и использовать переменные окружения. В skill-файлах заменить реальные пароли на `$WP_APP_PASS` или `<APP_PASSWORD>`. Ротировать WP app password и Google OAuth client_secret.

---

## Структура и гигиена

### Мусор в корне (удалить)

| Файл | Размер | Причина |
|------|--------|---------|
| `nul` | 0 B | Пустой файл (артефакт Windows) |
| `skills/nul` | 51 B | То же |
| `temp-ru-page.html` | 532 KB | Временный дамп |
| `temp-ru-page-fresh.html` | 212 KB | Временный дамп |
| `temp-seo-snippet.json` | 179 B | Пустой/артефакт |
| `full_audit.json` | 128 B | Пустой результат |
| `check_mu_plugins.json` | 457 B | Разовый чек |
| `opcache_reset.json` | 141 B | Разовый чек |
| `blocks-6-9.txt` | 850 B | Рабочий артефакт |
| `translation-progress.txt` | 143 B | Промежуточный лог |
| `translations-added-summary.txt` | 5.7 KB | Промежуточный лог |
| `check-translation.js` | 1 KB | Дубликат scripts/add-translation.js |
| `homepage-content.json` | 76 KB | Рабочий дамп |

### 5 дублей JSON snippet dumps (~2.2 MB суммарно)

Все — дампы WP Code Snippets, разница только в количестве записей (186–191):
- `all_snips.json` (191)
- `snips_current.json` (188)
- `current_snippets.json` (188)
- `snippets_audit.json` (189)
- `snips.json` (186)

**Рекомендация:** Оставить один (самый свежий — `all_snips.json`), остальные удалить. Или перенести в `archive/`.

### archive/ — 5.3 GB

`archive/scripts_old/` содержит ~250 файлов: старые Python-скрипты, скачанные изображения (egger_*, fenix_*, fundermax_*), скриншоты, JSON-дампы каталогов. Это 99% объёма всего проекта.

**Рекомендация:** Перенести на внешнее хранение или удалить. Образы (egger_full_collection, fenix_raw и т.д.) точно не нужны в git-репо.

### temp/ — 768 KB

20 файлов от сессии 9 февраля: homepage.html × 6 версий, snippet JSONs. Всё разовое.

**Рекомендация:** Очистить полностью.

---

## Git

**Ничего не закоммичено.** Все файлы в статусе `??` (untracked). `.git/` существует, но working tree пустая. Фактически git не используется.

**Рекомендация:** Сделать initial commit с правильным .gitignore. Текущий .gitignore неполный — не покрывает:
- `temp/`, `temp-*` (временные файлы)
- `archive/` (5.3 GB мусора)
- `*.html` в корне (дампы)
- `agents/.venv/`, `agents/__pycache__/`
- `knowledge/__pycache__/`
- `nul` (Windows артефакт)
- Крупные JSON-дампы (`all_snips.json`, `snips*.json` и т.д.)

---

## Skills

Структура хорошая, REGISTRY.md есть. Проблемы:

1. **seo-smm.md** — standalone файл, не папка со SKILL.md (нарушает паттерн)
2. **skills/nul** — мусор
3. **marketing/** — полный набор из 25+ skills, но большинство generic (не адаптированы под Studiokook)
4. **skills/_triggers.json** — дублирует REGISTRY.md по назначению
5. **Hardcoded credentials** в wp-elementor/SKILL.md и wp-translatepress/SKILL.md

---

## Agents

`agents/` содержит Python-код (main.py, seo_agent.py) + полный `.venv` (36 MB) + `.env` с API ключом. `.venv` и `__pycache__` не должны быть в репозитории.

`.claude/agents/` — 3 агента (seo-auditor, wp-specialist, studiokook-context) с memory. Это правильная структура.

---

## n8n

CLAUDE.md говорит: `n8n/dev/` и `n8n/prod/`. Реально: `n8n/dev/` и `n8n/workflows/`. Папки `prod/` нет. Всего 2 workflow-файла.

**Рекомендация:** Привести в соответствие с CLAUDE.md или обновить документацию.

---

## Knowledge/Database

- `knowledge/memory.db` (274 KB) — рабочая БД
- `knowledge/knowledge.db.backup` (192 KB) — бэкап, но нет основной knowledge.db
- `knowledge/__pycache__/` — мусор
- `knowledge/schema.sql` + `schema-memory.sql` — два schema файла (зачем оба?)
- `database/supabase-schema.sql` — отдельная папка ради одного файла

**Рекомендация:** Объединить database/ в knowledge/. Убрать __pycache__. Разобраться с двумя schema.

---

## Code Snippets

16 PHP-файлов + 3 PowerShell скрипта + README. Нумерация с пропусками (нет 15, скачок на 105). README содержит hardcoded credentials.

---

## Документы

Много отчётов разбросано по корню: SESSION-CHECKPOINT.md, SESSION_STATE.md, SEO_AUDIT_REPORT_2026.md, SEO_PAGES_TO_CHECK.md, IMPLEMENTATION_PACKAGE.md, AUDIT_DEBUG_OPTIMIZATION_REPORT_2026-02-10.md, seo-audit-multilang.md, wp-infrastructure-studiokook.md.

**Рекомендация:** Перенести все отчёты в `docs/` или `docs/reports/`. В корне оставить только CLAUDE.md и README.md.

---

## Приоритетный план действий

1. **Ротировать credentials** — WP app password, Google OAuth. Они засвечены в файлах.
2. **Зачистить hardcoded credentials** из всех файлов (15+ штук). Заменить на переменные.
3. **Обновить .gitignore** и сделать initial commit.
4. **Удалить мусор:** nul, temp/, temp-*, дубли JSON, пустые файлы.
5. **archive/scripts_old (5.3 GB)** — решить судьбу: удалить или вынести.
6. **Консолидировать документы** в docs/.
7. **Исправить n8n структуру** (dev/prod).
8. **Убрать .venv и __pycache__** из agents/ и knowledge/.
9. **Объединить database/ в knowledge/**.
10. **seo-smm.md** → `seo-smm/SKILL.md` для консистентности.
